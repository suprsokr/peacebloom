services:
  peacebloom:
    build: .
    image: peacebloom:latest
    container_name: peacebloom
    command: /bin/bash -c "tail -f /dev/null"
    volumes:
      # Persist compiled binaries, configs, and extracted maps
      - server:/home/peacebloom/server
      # Persist MySQL data
      - mysql_data:/var/lib/mysql
      # Mount WoW 3.3.5 client (required for map extraction and MPQ patching)
      # Configure WOTLK_PATH in your .env file
      - ${WOTLK_PATH}:/wotlk:rw
      # Mount mods workspace (edit with your IDE)
      - ./mods:/home/peacebloom/mods
      # Mount TrinityCore source (edit with your IDE, cloned by setup)
      - ./tc-source:/home/peacebloom/TrinityCore
      # Mount scripts (editable without rebuilding image)
      - ./scripts:/home/peacebloom/scripts
      # Mount Thorium source (for building from source if needed)
      - ../thorium:/home/peacebloom/thorium
    ports:
      - "3306:3306"  # MySQL
      - "3724:3724"  # AuthServer
      - "8085:8085"  # WorldServer
    stdin_open: true
    tty: true
    privileged: true

volumes:
  server:
  mysql_data:
